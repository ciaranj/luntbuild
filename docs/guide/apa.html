<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Appendix A. OGNL Expressions</title><link rel="stylesheet" href="luntbuild.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.67.2"><link rel="start" href="index.html" title="Luntbuild - Build Automation and Management User's Guide"><link rel="up" href="index.html" title="Luntbuild - Build Automation and Management User's Guide"><link rel="prev" href="ch22s03.html" title="Data migration by using export and import."></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Appendix A. OGNL Expressions</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch22s03.html"><img src="../images/prev.gif" alt="Prev"></a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> </td></tr></table><hr></div><div class="appendix" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="buildognl"></a>Appendix A. OGNL Expressions</h2></div></div></div><p>
Luntbuild Builder and Schedule can use OGNL expressions. Builder evaluates OGNL expressions of its Build Properties
values. Schedule evaluates OGNL expressions of its Next build version. While Builder evaluates OGNL expressions
in context of com.luntsys.luntbuild.builders.Builder class, Schedule evaluates OGNL expressions in context
of com.luntsys.luntbuild.db.Schedule class.
Please see <a href="http://luntbuild.javaforge.com/docs/javadoc/index.html" target="_top">javadoc</a> for detail of classes involved
in OGNL expression evaluation.
</p><p>
    Following are some examples of available Builder OGNL expressions:
</p><div class="variablelist"><dl><dt><span class="term">build.version</span></dt><dd><p>
    Build version
    </p></dd><dt><span class="term">build.artifactsDir</span></dt><dd><p>
    Build artifacts directory, subdirectory of the build.publishDir.
    </p></dd><dt><span class="term">build.publishDir</span></dt><dd><p>
    Build publish directory.
    </p></dd><dt><span class="term">build.junitHtmlReportDir</span></dt><dd><p>
    JUnit tests Html reports directory
    </p></dd><dt><span class="term">build.schedule.name</span></dt><dd><p>
    Build schedule name.
    </p></dd><dt><span class="term">build.schedule.description</span></dt><dd><p>
    Build schedule description.
    </p></dd><dt><span class="term">build.schedule.workingDir</span></dt><dd><p>
    Build schedule work directory.
    </p></dd><dt><span class="term">build.schedule.vcsModified</span></dt><dd><p>
    Was VCS modified?
    </p></dd><dt><span class="term">build.schedule.dependencyNewer</span></dt><dd><p>
    Is dependent schedule newer?
    </p></dd><dt><span class="term">build.schedule.project.name</span></dt><dd><p>
    Build project name.
    </p></dd><dt><span class="term">build.schedule.project.description</span></dt><dd><p>
    Build project description.
    </p></dd></dl></div><p>
Here are some examples to show the format of the OGNL expressions:
</p><div class="orderedlist"><ol type="1"><li><p>
        <span class="emphasis"><em>vcsModified</em></span> - this expression will evaluate to true if the repository
        content of the current build changes
    </p></li><li><p>
        <span class="emphasis"><em>getProject("testcvs").isVcsModifiedSince("11/11/2005")</em></span> - this expression
        will evaluate to true if the "testcvs" project changed since "11/11/2005". For current project
        the expression would be <span class="emphasis"><em>getProject().isVcsModifiedSince("11/11/2005")</em></span>.
    </p></li><li><p>
        <span class="emphasis"><em>getProject("testcvs").isVcsModified()</em></span> - this expression
        will evaluate to true if the "testcvs" project changed since the last build. For current project
        the expression would be <span class="emphasis"><em>getProject().isVcsModified()</em></span>.
    </p></li><li><p>
        <span class="emphasis"><em>ant("/path/to/command.xml", "targetA") == 0</em></span> - this expression
        will evaluate to true if execution of targetA of ant script file /path/to/command.xml
        returns <span class="emphasis"><em>success</em></span>.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../images/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>
            Special characters such as '\', '"', should be escaped with '\', just like in Java strings.
            The Ant file path will be assumed relative to current project work directory,
            if it is not an absolute path. If the target is "" or null, the default target will be assumed.
        </p></td></tr></table></div></li><li><p>
        <span class="emphasis"><em>execute("/path/to/command.sh") == 0</em></span> - this expression will evaluate
        to true if the return code of the execution of the specified command is 0.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../images/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>
            Special characters such as '\', '"', should be escaped with '\', just like in Java strings.
        </p></td></tr></table></div></li></ol></div><p>
	The above expressions can be prefixed with '!' to inverse the value,
	for example <span class="emphasis"><em>!modified</em></span> will be true when there are no modifications
	in the repository of the current project.
</p><p>
	The above expressions can be joined with "and", and "or". For example, the expression:
	<span class="emphasis"><em>modified or execute("/path/to/command.sh")==0</em></span> will be true,
	if repository content of the current project changes, or execution of the specified command returns 0.
</p><p>
    The above expressions can be prefixed with '!' to negate the value,
    for example "!modified" will evaluate to true when there are no modifications
    in the repository of current view.  The above expressions can also be joined with "and", "or".
    For example, the expression
    <span class="emphasis"><em>modified or execute("/path/to/command.sh")==0</em></span> will evaluate to true
    if the repository content of the current view changes, or execution of the specified command returns 0.
</p><p>
    Sometimes in might be handy to have your own class available for OGNL evaluation.
    Luntbuild supports a simple extension mechanism, so that when a JAR containing
    luntbuild_extension.properties is placed into Luntbuild's classpath,
    a class that has been defined in the property file can be accessed trough the
    <span class="emphasis"><em>system</em></span> object like this:
    </p><table class="simplelist" border="0" summary="Simple list"><tr><td>${system.getExtension("MyExtension").getHelloWorld()}</td></tr></table><p>
</p><p>
    Contents of the property file look like this:
    </p><table class="simplelist" border="0" summary="Simple list"><tr><td>luntbuild.extension.name=MyExtension</td></tr><tr><td>luntbuild.extension.class=org.example.MyExtension</td></tr></table><p>
    The mechanism is built completely into com.luntsys.luntbuild.utility.OgnlHelper class so,
    that the helper classes are instantiated once and instances stored in a static Hashtable.
    Methods of the extension classes should be made thread safe.
</p><p>
Please go to
<a href="http://www.ognl.org" target="_top"><em class="citetitle">http://www.ognl.org</em></a>
to learn more about general grammar of an OGNL expression.
</p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch22s03.html"><img src="../images/prev.gif" alt="Prev"></a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> </td></tr><tr><td width="40%" align="left" valign="top">Data migration by using export and import. </td><td width="20%" align="center"><a accesskey="h" href="index.html"><img src="../images/home.gif" alt="Home"></a></td><td width="40%" align="right" valign="top"> </td></tr></table></div></body></html>
